{
  "hash": "2319c387950b092f86d6796d2dad4b9a",
  "result": {
    "markdown": "---\ntitle: \"Lung disease in the United Kingdom\"\ndescription: Using a time series analysis to decompose lung diseas in the UK\neditor: visual\nauthor:\n  - name: Kiran Favre\n    url: https://kiranfavre.github.io\n    affiliation: Master of Environmental Data Science\n    affiliation-url: https://ucsb-meds.github.io/\ndate: 11-18-2022\ncitation: \n  url: https://kiranfavre.github.io/posts/2023-11-18_timeseries/ \ncategories: [Statistics, Time Series, R]\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Show code\"\nimage: IMG_7284.jpg\n---\n\n\n## Introduction\n\nI am interested in the number of deaths from lung diseases in the UK over time, considering that it's likely that lung disease deaths have declined over time, as smoking has declined in prevalence and medical treatments for lung disease have improved. However, we also know that there is likely to be seasonality in these deaths, because respiratory diseases tend to be exacerbated by climatic conditions. I want to pull apart this seasonal signal from the longer run trend.\n\n## Data\n\nI will be using the `mdeaths` dataset that is included in `R`. This contains a time series of monthly deaths from bronchitis, emphysema and asthma in the UK between 1974 and 1979 for males.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\nLoading required package: fabletools\n\n\nAttaching package: 'tsibble'\n\n\nThe following object is masked from 'package:lubridate':\n\n    interval\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, union\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#load in mdeaths (is already a ts obj)\nmdeaths_data <- mdeaths \n\n#convert ts to tsibble to make this easier to work with\nmdeaths_tsibble <- as_tsibble(mdeaths_data,\n                              index = yearmonth)  \n```\n:::\n\n\n## Time Series Analysis\n\n### Simple Time Series Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#simple time series\nplot(mdeaths_data,\n     main = \"Time Series Analysis of Male Deaths by Lung Disease in the UK\",\n     col = \"blue\",\n     xlab = \"Year\",\n     ylab = \"Number of Male Deaths\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#mdeaths_tsibble\n```\n:::\n\n\n### Classical Decomposition\n\nTo recover seasonality separately from the long run trend, I will use a classical decomposition. This will allow me to break total deaths $D_t$ into a trend component $T_t$, a seasonal component $S_t$, and a random component $R_t$. I will make the assumption that an additive model describes our data, as I don't see evidence in the above plot that the magnitude of seasonality is changing over time:\n\n$$D_t = S_t + T_t + R_t$$ To understand this decomposition, I'll make a plot which shows the time series in the raw data, the long run trend, the seasonal component, and the remainder random component.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmdeaths_tsibble |> \n  model(classical_decomposition(value, type = \"additive\")) |>\n  components() |> \n  autoplot() +\n  labs(title =  \"Time Series Analysis of Male Deaths by Lung Disease in the UK\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 6 rows containing missing values (`geom_line()`).\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nThe grey bars on the side of the decomposition plot are there to help assess how \"big\" each component is. Since the\\* y\\*-axes vary across each plot, it's hard to compare the magnitude of a trend or a seasonal cycle across plots without these grey bars. All grey bars are of the same magnitude; here, about 250. So, when the bar is small relative to the variation shown in a plot, that means that component is quantitatively important in determining overall variation.\n\nThere is evidence for a long-run downward trend over time, but it is not greatly contributing to the overall variation in the value. There is evidence of seasonality, exhibited by the cyclical nature of the curve in the seasonality section. The seasonal component is more important in driving overall variation in male lung disease deaths.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}